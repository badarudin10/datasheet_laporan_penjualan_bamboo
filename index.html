<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BambooArt Dashboard 2026</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #1a2a1f; background-image: url('https://www.transparenttextures.com/patterns/dark-wood.png'); color: white; }
        .glass-card { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 1rem; }
        .bg-card-green { background: #5cb85c; }
        .bg-card-blue { background: #5bc0de; }
        .bg-card-red { background: #d9534f; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-6xl mx-auto">
        <div class="flex justify-between items-center mb-8">
            <div class="flex items-center gap-3">
                <img src="https://img.icons8.com/color/48/bamboo.png" class="w-10 h-10">
                <h1 class="text-2xl font-bold tracking-tight">BambooArt Dashboard</h1>
            </div>
            <div class="flex gap-2">
                <button onclick="window.print()" class="bg-white text-gray-800 px-4 py-2 rounded font-bold text-sm shadow">Cetat PDF</button>
                <div class="bg-black/30 border border-white/20 px-4 py-2 rounded text-sm font-bold">‚úÖ Tahun Buku 2026</div>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
            <div class="bg-card-green p-6 rounded-lg shadow-lg">
                <p class="text-xs font-bold uppercase mb-1">Total Omzet Tahunan</p>
                <h2 id="displayRev" class="text-2xl font-black italic">Rp 0</h2>
            </div>
            <div class="bg-card-blue p-6 rounded-lg shadow-lg">
                <p class="text-xs font-bold uppercase mb-1">Total Unit Terjeal</p>
                <h2 id="displaySold" class="text-3xl font-black italic text-white">0</h2>
                <p class="text-[10px] mt-1 font-bold">38% dari total produckh teryal</p>
            </div>
            <div class="bg-card-red p-6 rounded-lg shadow-lg">
                <p class="text-xs font-bold uppercase mb-1">Stok Tesseriba</p>
                <h2 id="displayStock" class="text-2xl font-black italic text-white">0</h2>
                <div class="mt-2 bg-black/20 text-[10px] py-1 px-2 rounded font-bold inline-block italic italic italic">‚ö†Ô∏è Status: Stok Critis!</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-8">
            <div class="glass-card p-6">
                <h3 class="text-lg font-bold mb-4 italic">Grafik Pensallan Bulnalan</h3>
                <div class="h-64"><canvas id="lineChart"></canvas></div>
            </div>
            <div class="glass-card p-6">
                <h3 class="text-lg font-bold mb-4 italic">Komposia Pensullan per Kategori</h3>
                <div class="flex justify-between items-center">
                    <img src="https://quickchart.io/chart?c={type:'pie',data:{labels:['A','B','C'],datasets:[{data:[35,40,25],backgroundColor:['#1b5e20','#4caf50','#81c784']}]}}" class="w-32 h-32">
                    <div class="bg-white/10 p-4 rounded-lg flex-1 ml-4">
                        <p class="text-sm font-bold text-yellow-500">üèÜ Produk Favorit</p>
                        <p class="text-xs mt-2">Bulan Terpadat: <br><b>Juli (450 Unit)</b></p>
                    </div>
                </div>
            </div>
        </div>

        <div class="mb-8">
            <h3 class="text-xl font-bold mb-4 text-center italic">Produk Ungullan - Bestseller 2026</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-white rounded-lg overflow-hidden text-gray-800">
                    <img src="https://raw.githubusercontent.com/badarudin10/datasheet_laporan_penjualan_bamboo/main/kapal.jpg" onerror="this.src='https://images.unsplash.com/photo-1544413647-ad6717a26f98?w=400'" class="h-48 w-full object-cover">
                    <div class="p-4 text-center">
                        <p class="font-bold text-sm">Kapal Pinisi & Kapal Bambu</p>
                        <p class="text-[10px] text-gray-400 uppercase">Total Unit terjual: 135</p>
                    </div>
                </div>
                <div class="bg-white rounded-lg overflow-hidden text-gray-800">
                    <img src="https://raw.githubusercontent.com/badarudin10/datasheet_laporan_penjualan_bamboo/main/rumah.jpg" onerror="this.src='https://images.unsplash.com/photo-1518780664697-55e3ad937233?w=400'" class="h-48 w-full object-cover">
                    <div class="p-4 text-center">
                        <p class="font-bold text-sm">Rumah Tradisional & Rumah Detail</p>
                        <p class="text-[10px] text-gray-400 uppercase">Total Unit terjual: 135</p>
                    </div>
                </div>
                <div class="bg-white rounded-lg overflow-hidden text-gray-800">
                    <img src="https://raw.githubusercontent.com/badarudin10/datasheet_laporan_penjualan_bamboo/main/mobil.jpg" onerror="this.src='https://images.unsplash.com/photo-1533473359331-0135ef1b58bf?w=400'" class="h-48 w-full object-cover">
                    <div class="p-4 text-center">
                        <p class="font-bold text-sm">Mobil Bambu & Mobil Klasik</p>
                        <p class="text-[10px] text-gray-400 uppercase">Total Unit terjual: 135</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="glass-card overflow-hidden mb-10">
            <div class="p-4 bg-white/5 font-bold text-sm uppercase italic tracking-widest">Inventory Detail</div>
            <div class="overflow-x-auto">
                <table class="w-full text-left text-xs">
                    <thead class="bg-white/10 text-green-400">
                        <tr>
                            <th class="p-4">PRODUK</th>
                            <th class="p-4 text-center">TERJUAL</th>
                            <th class="p-4 text-center text-center">STOK</th>
                            <th class="p-4 text-right">STATUS</th>
                        </tr>
                    </thead>
                    <tbody id="inventoryBody" class="divide-y divide-white/5"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQXdrHU-IFBl2jmf3Unzy8Jb2Uh7VfK5uvX0OeO7Ivlc88QC6ahXNFJf1VlGWlTb7Mfp4xzeSY6BsXx/pub?output=csv";

        function syncData() {
            Papa.parse(sheetUrl, {
                download: true,
                complete: function(results) {
                    const data = results.data;
                    
                    // MENCARI BARIS TOTAL (Biasanya di baris paling bawah)
                    const totalRow = data.find(r => r.join('').toUpperCase().includes("TOTAL"));
                    
                    if (totalRow) {
                        // Ambil data (sesuaikan kolom secara manual di sini: 18=Terjual, 19=Stok, 20=Omzet)
                        document.getElementById('displaySold').innerText = totalRow[18] || "0";
                        document.getElementById('displayStock').innerText = totalRow[19] || "0";
                        document.getElementById('displayRev').innerText = "Rp " + (totalRow[20] || "0");

                        const monthly = totalRow.slice(4, 16).map(v => parseInt(v.replace(/\D/g, '')) || 0);
                        renderChart(monthly);
                    }

                    // ISI TABEL
                    const tbody = document.getElementById('inventoryBody');
                    tbody.innerHTML = '';
                    data.forEach((row, i) => {
                        // Mulai baca setelah header (baris 3+) dan pastikan ada nama produk
                        if (i > 2 && row[2] && !row[2].toUpperCase().includes("TOTAL")) {
                            const s = parseInt(row[19]) || 0;
                            tbody.innerHTML += `
                                <tr class="hover:bg-white/5 transition">
                                    <td class="p-4 font-bold">${row[2]}</td>
                                    <td class="p-4 text-center font-mono text-blue-300">${row[18] || 0}</td>
                                    <td class="p-4 text-center font-mono">${s}</td>
                                    <td class="p-4 text-right">
                                        <span class="px-2 py-1 rounded text-[9px] font-bold ${s < 20 ? 'bg-red-500/20 text-red-500' : 'bg-green-500/20 text-green-500'}">
                                            ${s < 20 ? 'KRITIS' : 'AMAN'}
                                        </span>
                                    </td>
                                </tr>`;
                        }
                    });
                }
            });
        }

        function renderChart(data) {
            const ctx = document.getElementById('lineChart');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jan','Feb','Mar','Apr','Mei','Jun','Jul','Agu','Sep','Okt','Nov','Des'],
                    datasets: [{
                        data: data, borderColor: '#4caf50', tension: 0.4, fill: true,
                        backgroundColor: 'rgba(76, 175, 80, 0.1)', borderWidth: 3, pointRadius: 4
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, 
                    scales: { y: { display: false }, x: { ticks: { color: 'rgba(255,255,255,0.5)', font: {size: 10} }, grid: { display: false } } }
                }
            });
        }

        syncData();
        setInterval(syncData, 300000);
    </script>
</body>
</html>
